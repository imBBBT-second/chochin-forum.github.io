<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0" />
<title>초친 포럼 (레벨 - 클래식)</title>

<style>
html, body {
  height: 100%;
  margin: 0;
  background: #323232;
  display: flex;
  flex-direction: column;
  overflow-x: hidden;
}
* { box-sizing: border-box; }

/* ===== Font ===== */
@font-face { font-family: Paperlogy1; src: url('font - paperlogy/Paperlogy-1.ttf'); }
@font-face { font-family: Paperlogy2; src: url('font - paperlogy/Paperlogy-2.ttf'); }
@font-face { font-family: Paperlogy3; src: url('font - paperlogy/Paperlogy-3.ttf'); }
@font-face { font-family: Paperlogy4; src: url('font - paperlogy/Paperlogy-4.ttf'); }
@font-face { font-family: Paperlogy5; src: url('font - paperlogy/Paperlogy-5.ttf'); }
@font-face { font-family: Paperlogy6; src: url('font - paperlogy/Paperlogy-6.ttf'); }
@font-face { font-family: Paperlogy7; src: url('font - paperlogy/Paperlogy-7.ttf'); }
@font-face { font-family: Paperlogy8; src: url('font - paperlogy/Paperlogy-8.ttf'); }
@font-face { font-family: Paperlogy9; src: url('font - paperlogy/Paperlogy-9.ttf'); }


/* ===== Common ===== */
h1 { font-family: Paperlogy7; color:white; font-size:170px; text-align:center; }
h4 { font-family: Paperlogy3; color:#a0a0a0; text-align:center; }
p, span { font-family: Paperlogy2; color:#c8c8c8; }
a { color: inherit; text-decoration: none; }

  
/* ===== Header ===== */
.header-container {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 5vw;
    padding: 1vh 0;
    flex-wrap: wrap;
  }

  .header-btn-wrapper {
    width: 400px; /* 원하는 고정 너비로 맞춰 (필요하면 숫자 조절) */
    display: flex;
    justify-content: center;
  }

  .header-btn {
    background-color: #323232;
    color: white;
    font-size: clamp(2rem, 5vw, 5rem);
    cursor: pointer;
    padding: 1.5vh 0; /* 좌우 패딩 없애고 위아래만 */
    border: none;
    border-radius: 10px;
    width: 100%; /* wrapper 안에서 꽉 차게 */
    transition: background-color 0.25s ease, color 0.25s ease;
    font-family: Paperlogy5;
  }

  .header-btn:hover {
    background-color: #fff;
    color: #323232;
  }
  .divider {
    border: 2px solid white;
    width: 100%;
    height: 0;
    margin: 6px 0;
  }

/* ===== Layout ===== */
.main-container {
  flex:1;
  display:flex;
  gap:2%;
  padding:1.2%;
  min-height:1000px;
}

.container,
.detail-panel,
.detail-panel.clears-panel {
  min-height: 900px;
}


/* ===== Left List & Right Clears (same size) ===== */
.container,
.detail-panel.clears-panel {
  background:#404040;
  border-radius:10px;
  padding:1.5%;
  display:flex;
  flex-direction:column;
  overflow:hidden;
}

.container {
  flex: 0 0 25%;
  max-width: 25%;
}

.detail-panel {
  flex: 0 0 50%;
  max-width: 50%;
}

.detail-panel.clears-panel {
  flex: 0 0 25%;
  max-width: 25%;
}


input {
  font-size:18px;
  border-radius:8px;
  border:none;
  padding:8px;
  margin-bottom:10px;
}

.tag-filter {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-bottom: 10px;
}

.tag-filter .tag {
  background: #555;
  color: #fff;
  padding: 4px 10px;
  border-radius: 999px;
  font-size: 14px;
  cursor: pointer;
  user-select: none;
  font-family: Paperlogy5;
}

.tag-filter .tag.active {
  background: #ffffff;
  color: #000000;
}

.tag-group {
  background: #3f3f3f;
  border-radius: 10px;
  padding: 10px 12px;
  display: flex;
  flex-direction: column;
  gap: 6px;

  /* 너무 커지지 않게 */
  min-width: 180px;
}


.tag-group-title {
  font-size: 16px;
  opacity: 0.7;
  margin-bottom: 6px;
  font-family: Paperlogy5;
  color: white;
}

.tag-group-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}


.tag-group-title {
  font-family: Paperlogy6;
  font-size: 18px;
  color: #ffffff;
  margin-bottom: 6px;
  letter-spacing: 0.5px;
  opacity: 0.9;
}

.tag-filter-title {
  font-family: Paperlogy7;
  font-size: 16px;
  color: #eaeaea;
  margin: 12px 0 6px;
  padding-left: 4px;
  border-left: 3px solid #888;
}

#detailDescription {
  display: flex;
  flex-wrap: wrap;
  gap: 14px;
}

  
/* ===== List Item ===== */
.item {
  display:flex;
  padding: 0.9rem 0.5rem;
  gap: 0.8rem;
  border-bottom:1px solid #777;
  cursor:pointer;
}
.rank {
  font-family: Paperlogy9;
  font-size: 3.2rem;
  width: 3.2rem;
  text-align: center;
  color: #ffffff;
}

.title {
  font-family: Paperlogy7;
  font-size: 2.4rem;
  line-height: 1.3;
  color: #ffffff;
}

.creator {
  font-family: Paperlogy4;
  font-size: 1rem;
  color: #d0d0d0;
}

/* 기본 상태 */
.item {
  transition:
    background-color 0.15s ease,
    color 0.15s ease;
}

.item:hover {
  background-color: #ffffff;
}

.item:hover .title,
.item:hover .creator,
.item:hover .rank {
  color: #000000;
}


/* 선택된 버튼 */
.item.active {
  background-color: #ffffff;
}

/* 선택된 버튼 텍스트 */
.item.active .title,
.item.active .creator,
.item.active .rank {
  color: #000000;
}

/* ===== Center Detail ===== */
.detail-panel {
  flex:1;
  background:#505050;
  border-radius:10px;
  padding:1.5%;
  display:flex;
  flex-direction:column;
  overflow-y:auto;
}

.detail-header {
  display: flex;
  flex-direction: column;
  align-items: center;   /* 핵심 */
  text-align: center;
  margin-bottom: 10px;
}

#detailCreator {
  font-family: Paperlogy4;
  font-size: 1.6rem;
  color: #c8c8c8;
  margin-top: 4px;
}

.detail-title {
  font-family: Paperlogy9;
  font-size: 4.8rem;
  color: #ffffff;
  line-height: 1.1;
  text-align: center;
  white-space: nowrap;
  display: flex;
  justify-content: center;
  align-items: center;
  margin-bottom: 6px;
}

/* ===== Video ===== */
.video-wrapper {
  position:relative;
  width:100%;
  padding-top:56.25%;
}
.video-wrapper iframe {
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  border:none;
}

/* ===== Section ===== */
.section {
  background:#444;
  border-radius:8px;
  padding:12px;
  margin-top:12px;
}
.section-title {
  font-family:Paperlogy6;
  font-size:22px;
  color:#fff;
  margin-bottom:8px;
}

.section p {
  color: #c8c8c8;
  font-family: Paperlogy3;
  font-size: 1rem;
}


#list {
  flex: 1;
  overflow-y: auto;
}

.detail-content {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.info-section,
.graph-section,
.tag-section {
  background: #444;
  padding: 14px;
  border-radius: 10px;
}

.info-row {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  font-family: Paperlogy3;
  font-size: 1rem;
  color: #c8c8c8;
}

.info-row span {
  min-width: 45%;
}

.fp-warning {
  text-align: center;
  font-family: Paperlogy2;
  font-size: 0.9rem;
  color: #aaa;
  margin-top: 10px;
}

  
/* ===== Bar Graph ===== */
.graph-box {
  margin-bottom: 14px;
}

.graph-title {
  font-family: Paperlogy6;
  font-size: 1.2rem;
  color: #fff;
  margin-bottom: 6px;
}

.graph-row {
  display: flex;
  align-items: center;
  gap: 8px;
  margin: 4px 0;
}

.graph-label {
  width: 90px;
  font-family: Paperlogy3;
  font-size: 0.9rem;
  color: #c8c8c8;
  flex-shrink: 0;
}

.graph-bar-bg {
  flex: 1;
  background: #333;
  border-radius: 6px;
  overflow: hidden;
  height: 16px;
}

.graph-bar {
  height: 100%;
  background: linear-gradient(90deg, #6fa8ff, #9bd0ff);
  border-radius: 6px;
}

.graph-value {
  width: 50px;
  text-align: right;
  font-family: Paperlogy4;
  font-size: 0.9rem;
  color: #c8c8c8;
}

.graph-total {
  margin-left: 8px;
  font-size: 0.85rem;
  color: #ccc;
  font-family: Paperlogy3;
}


.tag {
  display: inline-flex;
  align-items: center;
  justify-content: center;

  background: #5f5f5f;
  color: #ffffff;

  font-family: Paperlogy4;
  font-size: 1rem;

  padding: 6px 14px;
  border-radius: 12px;

  margin: 4px 6px 4px 0;
  white-space: nowrap;
}

/* ================= 그래프 색상 ================= */

/* 게임모드 */
.graph-bar[data-key="Cube"]   { background:#00ff00; }
.graph-bar[data-key="Ship"]   { background:#ff00ff; }
.graph-bar[data-key="Ball"]   { background:#ff0000; }
.graph-bar[data-key="UFO"]    { background:#ff9900; }
.graph-bar[data-key="Wave"]   { background:#66ccff; }
.graph-bar[data-key="Robot"]  { background:#ffffff; }
.graph-bar[data-key="Spider"] { background:#9900ff; }
.graph-bar[data-key="Swing"]  { background:#ffff00; }

/* 속도 */
.graph-bar[data-key="0.5x"] { background:#ffff00; }
.graph-bar[data-key="1x"]   { background:#66ccff; }
.graph-bar[data-key="2x"]   { background:#00ff00; }
.graph-bar[data-key="3x"]   { background:#ff66cc; }
.graph-bar[data-key="4x"]   { background:#ff0000; }

/* 프레임 퍼펙트 */
.graph-bar[data-key="30"]  { background:#66ccff; }
.graph-bar[data-key="60"]  { background:#00ff00; }
.graph-bar[data-key="120"] { background:#ffff00; }
.graph-bar[data-key="240"] { background:#ff0000; }
  
/* === 클리어 명단 전용 스타일 === */
.clears-panel {
  color: #e0e0e0;
}

.clear-row {
  display: flex;
  align-items: center;
  gap: 0.6vw;
  padding: 6px 4px;

  font-family: Paperlogy3;
  font-size: 1.1vw;
  color: #e0e0e0;
}

.clear-rank {
  font-family: Paperlogy6;
  color: #ffffff;
  min-width: 3.5vw;
}

.clear-player {
  flex: 1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.clear-date {
  font-family: Paperlogy2;
  font-size: 0.95vw;
  color: #b0b0b0;
}

/* === 클리어 순위 강조 (닉네임 흰색 유지) === */
.clear-row.rank-1 .clear-rank {
  color: #ffe066;
  font-family: Paperlogy6;
}

.clear-row.rank-2 .clear-rank {
  color: #e6e6e6;
  font-family: Paperlogy5;
}

.clear-row.rank-3 .clear-rank {
  color: #ffb266;
  font-family: Paperlogy5;
}

/* 닉네임은 항상 흰색 */
.clear-player {
  color: #ffffff;
  font-family: Paperlogy5;
}



</style>
</head>

<body>

<div class="header-container">
  <a href="../index.html" class="header-btn-wrapper" style="text-decoration: none"><button class="header-btn">홈</button></a>
  <a href="../level.html" class="header-btn-wrapper" style="text-decoration: none"><button class="header-btn" style="font-family:Paperlogy9">레벨</button></a>
  <a href="../hardest.html" class="header-btn-wrapper" style="text-decoration: none"><button class="header-btn">하디스트</button></a>
</div>

<div class="divider"></div>


<h1 style="font-size: 12.8rem;">Classic</h1>
<p style="font-size: 1.6rem; text-align: center; position: relative; bottom: 10%;">초친 멤버들이 만든 레벨들 중 20초 이상의 레벨들을 모아놓은 곳입니다.</p>

<div class="main-container">
  <!-- Left -->
  <div class="container">
    <input id="search" placeholder="검색" />
    <div id="tagFilter" class="tag-filter"></div>
    <div id="list" style="overflow-y:auto"></div>
  </div>

  <!-- Detail -->
  <div class="detail-panel">

  <!-- 제목 / 제작자 -->
  <div class="detail-header">
    <div id="detailTitle" class="detail-title"></div>
    <div id="detailCreator" class="detail-creator"></div>
  </div>

  <!-- 영상 -->
  <div class="video-wrapper">
    <iframe id="detailVideo" allowfullscreen></iframe>
  </div>

  <!-- 상세 정보 -->
  <div class="detail-content">

    <!-- 텍스트 정보 -->
    <div id="infoSection" class="info-section"></div>

    <!-- 그래프 -->
    <div id="graphSection" class="graph-section"></div>

    <!-- 태그 -->
    <div id="detailDescription"></div>


  </div>

  <p class="fp-warning">※ 프레임 퍼펙트는 정확하지 않습니다 ※</p>
</div>


  <!-- Clears -->
  <div class="detail-panel clears-panel">
    <div style="font-family:Paperlogy9;font-size:3.2rem;text-align:center;color:white;">클리어 명단</div>
    <div id="detailClears"></div>
  </div>
</div>

<script>
const TAG_GROUPS = {
  '게임모드': ['Cube', 'Ship', 'Ball', 'UFO', 'Wave', 'Robot', 'Spider', 'Swing', 'Any-Mode'],
  '속도': ['0.5x', '1x', '2x', '3x', '4x', 'Any-Speed'],
  '길이': ['Short', 'Medium', 'Long', 'XL'],
  '성격': ['Memory', 'Sync', 'Gimmick', 'Physical'],
  '특이사항': ['None-Effect', 'Low-Effect', 'Full-Effect', 'One-Mode'],
};


const selectedTags = new Set();
let demonData = [];

/* 태그 섹션용 */
function addSection(title, html) {
  const box = document.getElementById('detailDescription');

  const div = document.createElement('div');
  div.className = 'section';
  div.innerHTML = `
    <div class="section-title">${title}</div>
    ${html}
  `;

  box.appendChild(div);
}


/* 그래프 생성 */
function makeRatioGraph(title, data, suffix = '%', totalValue = null) {
  if (!data || Object.keys(data).length === 0) return '';

  return `
    <div class="graph-box">
      <div class="graph-title">
        ${title}
        ${totalValue !== null ? `<span class="graph-total">(Total : ${totalValue})</span>` : ''}
      </div>

      ${Object.entries(data).map(([k, v]) => `
        <div class="graph-row">
          <div class="graph-label">${k}</div>
          <div class="graph-bar-bg">
            <div class="graph-bar" data-key="${k}" style="width:${v}%"></div>
          </div>
          <div class="graph-value">${v}${suffix}</div>
        </div>
      `).join('')}
    </div>
  `;
}
  
function showDetail(item, element) {
  document.getElementById('detailDescription').innerHTML = '';
  // active 제거
  document.querySelectorAll('.item.active')
    .forEach(el => el.classList.remove('active'));

  // element가 있을 때만 active 처리
  if (element) {
    element.classList.add('active');
  }
  /* 제목 */
  document.getElementById('detailTitle').textContent = item.title;

  /* 제작자 */
  document.getElementById('detailCreator').textContent =
    item.creator === item.verifier
      ? `by ${item.creator}`
      : `by ${item.creator} / Verified by ${item.verifier}`;

  /* 영상 */
  document.getElementById('detailVideo').src = item.video || '';

  /* 텍스트 정보 */
  const info = document.getElementById('infoSection');
  info.innerHTML = '';

  if (item.map) {
    info.innerHTML += `
      <div class="info-row">
        <span>맵 ID : ${item.map.mapId}</span>
        <span>길이 : ${item.map.length}</span>
        <span>오브젝트 수 : ${item.map.objects?.toLocaleString()}</span>
        <span>업로드 날짜 : ${item.map.uploadDate}</span>
      </div>
    `;
  }

  if (item.song) {
    info.innerHTML += `
      <div class="info-row">
        <span>노래 이름 : ${item.song.name}</span>
        <span>작곡가 : ${item.song.artist}</span>
        <span>노래 ID : ${item.song.id}</span>
      </div>
    `;
  }

  /* 그래프 */
  const graph = document.getElementById('graphSection');
  graph.innerHTML = '';

  if (item.gameplay) {
    graph.innerHTML += makeRatioGraph(
      '게임모드 비율',
      item.gameplay.modeRatio
    );

    graph.innerHTML += makeRatioGraph(
      '속도 비율',
      item.gameplay.speedRatio
    );
  }

  if (item.framePerfect) {
    const total = item.framePerfect.total || 0;
    const fps = item.framePerfect.fps || {};

    // 막대용 비율 계산
    const ratio = {};
    Object.entries(fps).forEach(([k, v]) => {
      ratio[k] = total > 0 ? ((v / total) * 100).toFixed(1) : 0;
    });

    // 그래프 생성 (막대는 ratio, 표시는 개수)
    graph.innerHTML += `
      <div class="graph-box">
        <div class="graph-title">
          프레임 퍼펙트 (FPS)
         <span class="graph-total">(Total : ${total})</span>
        </div>
  
        ${Object.entries(fps).map(([k, v]) => `
          <div class="graph-row">
            <div class="graph-label">${k}</div>
            <div class="graph-bar-bg">
              <div class="graph-bar" data-key="${k}" style="width:${ratio[k]}%"></div>
            </div>
            <div class="graph-value">${v}</div>
          </div>
        `).join('')}
      </div>
    `
    ;
  }
  
  /* 태그 */
  if (item.tags && item.tags.length > 0) {
  addSection('태그', renderTagGroups(item.tags));
  }
  
  const clearBox = document.getElementById('detailClears');
  clearBox.innerHTML = '';

  if (item.clears && item.clears.length > 0) {
    item.clears.forEach((c, i) => {
      const row = document.createElement('div');
      row.className = `clear-row rank-${i + 1}`;
      row.innerHTML = `
        <div class="clear-rank">#${i + 1}</div>
        <div class="clear-player">${c.player}</div>
        <div class="clear-date">${c.date}</div>
      `;
      clearBox.appendChild(row);
    });
  } else {
    clearBox.innerHTML =
      `<p style="text-align:center; color:#aaa; font-size: 1.6rem;">클리어 없음</p>`;
  }
}

function generateList(data) {
  const list = document.getElementById('list');
  list.innerHTML = '';

  data.forEach(d => {
    const div = document.createElement('div');
    div.className = 'item';
    div.innerHTML = `
      <div class="rank">${d.id}</div>
      <div>
        <div class="title">${d.title}</div>
        <div class="creator">by ${d.creator}</div>
      </div>
    `;

    div.onclick = () => showDetail(d, div);
    list.appendChild(div);
  });
}

  
fetch('classic.json')
  .then(r => r.json())
  .then(j => {
    demonData = j.buttons;
    initTagFilter(demonData);
    generateList(demonData);

    if (demonData.length > 0) {
      showDetail(demonData[0]);
    }
  });


  function applyFilter() {
  const text = search.value.toLowerCase();

  const filteredData = demonData.filter(item => {
    const textMatch = item.title.toLowerCase().includes(text);
    const tagMatch = [...selectedTags].every(tag =>
      item.tags?.includes(tag)
    );
    return textMatch && tagMatch;
  });

  generateList(filteredData);

  if (filteredData.length > 0) {
    showDetail(filteredData[0]);
  }
}


  function initTagFilter(data) {
  const tagBox = document.getElementById('tagFilter');
  tagBox.innerHTML = '';

  Object.entries(TAG_GROUPS).forEach(([group, values]) => {
    const groupDiv = document.createElement('div');
    groupDiv.className = 'tag-filter-group';

    groupDiv.innerHTML = `<div class="tag-filter-title">${group}</div>`;

    values.forEach(tag => {
      const el = document.createElement('span');
      el.className = 'tag';
      el.textContent = tag;

      el.onclick = () => {
        el.classList.toggle('active');
        selectedTags.has(tag)
          ? selectedTags.delete(tag)
          : selectedTags.add(tag);
        applyFilter();
      };

      groupDiv.appendChild(el);
    });

    tagBox.appendChild(groupDiv);
  });
}


function renderTagGroups(tags) {
  if (!tags || tags.length === 0) return '';

  let html = '';

  Object.entries(TAG_GROUPS).forEach(([group, values]) => {
    const matched = tags.filter(t => values.includes(t));
    if (matched.length === 0) return;

    html += `
      <div class="tag-group">
        <div class="tag-group-title">${group}</div>
        <div class="tag-group-tags">
          ${matched.map(t => `<span class="tag">${t}</span>`).join('')}
        </div>
      </div>
    `;
  });

  return html;
}


</script>


</body>
</html>






